# workflow.yml

main:
  params: [input_data]

  steps:
  # Step 1: Make a simple HTTP request to the Cloud Run service
  - invokeCloudRunService:
      call: http.get
      args:
        url: ${input_data.cloud_run_url}
      result: cloud_run_service_response

  - log_response_run:
      call: sys.log
      args:
        data: ${"Recieved cloud_run_url is = " + input_data.cloud_run_url}

  - invokeCloudFunctionsService:
      call: http.get
      args:
        url: ${input_data.cloud_functions_url}
      result: cloud_functions_service_response

  - log_response_functions:
      call: sys.log
      args:
        data: ${"Recieved cloud_functions_url is = " + input_data.cloud_functions_url}

  # Step 2: Return the response from the Cloud Run/Functions service
  - assign_vars:
      assign:
        - concatLines: ${"cloud_run_service_response = "+"{cloud_run_service_response}"}
        - concatLines: ${concatLines+"\n"}
        - concatLines: ${concatLines+"cloud_function_service_response = "+"{cloud_functions_service_response}"}
  - returnResponse:
      return: ${concatLines}